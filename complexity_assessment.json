{
  "complexity": "standard",
  "workflow_type": "feature",
  "confidence": 0.85,
  "reasoning": "This feature requires 10-15 files across frontend and backend, database migrations for photo and visibility tables, and cross-cutting integration between profile and chat systems. Requires research to understand existing file upload patterns and database schema, but the domain is well-understood with no exotic technologies.",

  "analysis": {
    "scope": {
      "estimated_files": 12,
      "estimated_services": 2,
      "is_cross_cutting": true,
      "notes": "Photo upload system integrates with both profile management and chat system. Will need frontend gallery UI, upload components, backend API, database models, and chat integration for sharing controls."
    },
    "integrations": {
      "external_services": ["file_storage"],
      "new_dependencies": ["file-upload-library", "possibly-image-processing"],
      "research_needed": true,
      "notes": "Need to research existing file upload patterns in codebase. File storage likely S3 or local filesystem. Will need to understand current database schema to design photo-match visibility junction table."
    },
    "infrastructure": {
      "docker_changes": false,
      "database_changes": true,
      "config_changes": true,
      "notes": "Requires database migrations for new Photo and PhotoVisibility tables. Config changes for upload limits (6 photos), storage paths, and possibly S3 credentials. No new Docker services needed."
    },
    "knowledge": {
      "patterns_exist": false,
      "research_required": true,
      "unfamiliar_tech": [],
      "notes": "Need to research: (1) existing file upload patterns, (2) current database schema and relationships, (3) chat system architecture for integration points. Domain is well-understood but implementation patterns need discovery."
    },
    "risk": {
      "level": "high",
      "concerns": [
        "Privacy enforcement - photos must be truly private by default",
        "Access control - per-match visibility must be enforced in backend",
        "Database schema complexity - photo-match visibility junction table",
        "Chat integration - avoid breaking existing chat features",
        "File storage security - proper access controls on uploaded files"
      ],
      "notes": "Privacy-critical feature requiring careful access control implementation. Per-match visibility adds state management complexity. Database schema must correctly model many-to-many relationship with visibility state."
    }
  },

  "recommended_phases": [
    "discovery",
    "requirements",
    "research",
    "context",
    "spec_writing",
    "planning",
    "validation"
  ],

  "flags": {
    "needs_research": true,
    "needs_self_critique": false,
    "needs_infrastructure_setup": true
  },

  "validation_recommendations": {
    "risk_level": "high",
    "skip_validation": false,
    "minimal_mode": false,
    "test_types_required": ["unit", "integration", "e2e"],
    "security_scan_required": true,
    "staging_deployment_required": false,
    "reasoning": "Privacy-critical feature with database changes and access control enforcement requires comprehensive testing. E2E tests needed for photo upload and sharing flows. Security scan essential to verify privacy enforcement and access control rules."
  },

  "created_at": "2025-12-27T10:30:00Z"
}
